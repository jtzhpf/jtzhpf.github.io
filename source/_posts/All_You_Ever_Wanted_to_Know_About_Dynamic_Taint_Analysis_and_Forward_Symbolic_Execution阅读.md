---
title: "All You Ever Wanted to Know About Dynamic Taint Analysis and Forward Symbolic Execution é˜…è¯»"
category: CS&Maths
#id: 57
date: 2023-10-30 09:00:00
tags: 
  - S&P
  - Dynamic Analysis
  - Symbolic Execution
  - Paper
toc: true
#sticky: 1 # æ•°å­—è¶Šå¤§ç½®é¡¶ä¼˜å…ˆçº§è¶Šé«˜ã€‚æ•°å­—éƒ½éœ€è¦å¤§äº 0ã€‚
#cover: /images/about.jpg # æŒ‡å®šå°é¢å›¾ç‰‡çš„ URL
timeline: article  # å±•ç¤ºåœ¨æ—¶é—´çº¿åˆ—è¡¨ä¸­
mathjax: true
---

æœ¬æ–‡è¯¦ç»†ä»‹ç»äº†åŠ¨æ€æ±¡ç‚¹åˆ†æï¼ˆDynamic Taint Analysisï¼‰å’Œå‰å‘ç¬¦å·æ‰§è¡Œï¼ˆForward Symbolic Executionï¼‰ã€‚
<!--more-->

# SIMPIL: A Simple Intermediate Language
![The Grammar of SIMPIL](/All_You_Ever_Wanted_to_Know_About_Dynamic_Taint_Analysis_and_Forward_Symbolic_Executioné˜…è¯»/image1.png){width=500px}

1. **ä¸€ç³»åˆ—å¸¦æœ‰ç¼–å·çš„è¯­å¥ï¼š**
    SIMPILä¸­çš„ç¨‹åºç”±ä¸€ç³»åˆ—è¯­å¥ç»„æˆï¼Œæ¯ä¸ªè¯­å¥éƒ½è¢«åˆ†é…ä¸€ä¸ªå”¯ä¸€çš„ç¼–å·ã€‚
  
2. **è¯­å¥çš„ç±»å‹ï¼š**

    SIMPILä¸­çš„è¯­å¥å¯ä»¥æ˜¯å¤šç§ç±»å‹ï¼š
    - **èµ‹å€¼è¯­å¥ï¼š** åŒ…æ‹¬å°†å€¼åˆ†é…ç»™å˜é‡çš„æ“ä½œã€‚
    - **æ–­è¨€è¯­å¥ï¼š** è¡¨è¾¾åœ¨ç¨‹åºä¸­æŸä¸ªç‚¹ä¸Šå§‹ç»ˆåº”è¯¥ä¸ºçœŸçš„æ¡ä»¶ã€‚
    - **è·³è½¬è¯­å¥ï¼š** å¯¼è‡´ç¨‹åºè·³è½¬åˆ°ä¸åŒè¯­å¥çš„è¯­å¥ã€‚
    - **æ¡ä»¶è·³è½¬è¯­å¥ï¼š** åŸºäºæ¡ä»¶è€Œå‘ç”Ÿè·³è½¬çš„è¯­å¥ã€‚

3. **æ— å‰¯ä½œç”¨çš„è¡¨è¾¾å¼ï¼š**
  SIMPILä¸­çš„è¡¨è¾¾å¼æ˜¯æ— å‰¯ä½œç”¨çš„ï¼Œè¿™æ„å‘³ç€å®ƒä»¬ä¸ä¼šæ”¹å˜ç¨‹åºçš„çŠ¶æ€ã€‚å‰¯ä½œç”¨é€šå¸¸æŒ‡çš„æ˜¯å¯¹å˜é‡æˆ–å…¶ä»–æœ‰çŠ¶æ€å…ƒç´ çš„ä¿®æ”¹ã€‚

1. **äºŒå…ƒå’Œä¸€å…ƒè¿ç®—ç¬¦ï¼š**
   - äºŒå…ƒè¿ç®—ç¬¦ç”±â€œ $\lozenge_{b}$ â€è¡¨ç¤ºï¼Œå…¶ä¸­æ–¹æ¡†å¯ä»¥å¡«å……å…¸å‹çš„äºŒå…ƒè¿ç®—ç¬¦ï¼Œå¦‚åŠ æ³•ã€å‡æ³•ç­‰ã€‚
   - ä¸€å…ƒè¿ç®—ç¬¦ç”±â€œ $\lozenge_{u}$ â€è¡¨ç¤ºï¼Œè¡¨ç¤ºé€»è¾‘å–åç­‰ä¸€å…ƒæ“ä½œã€‚

2. **è¾“å…¥è¯­å¥ï¼š**
   - è¯­å¥ $\mbox{get\_input}(src)$ ç”¨äºä»æŒ‡å®šçš„æº $src$ è·å–è¾“å…¥ã€‚

3. **ç‚¹ï¼ˆ$\cdot$ï¼‰ä½œä¸ºè¢«å¿½ç•¥çš„å‚æ•°ï¼š**
   - ç‚¹ï¼ˆ$\cdot$ï¼‰ç”¨äºè¡¨ç¤ºè¢«å¿½ç•¥çš„å‚æ•°ã€‚ä¾‹å¦‚ï¼Œå½“ç¡®åˆ‡çš„è¾“å…¥æºä¸ç›¸å…³æ—¶ï¼Œæˆ‘ä»¬ä¼šå†™æˆ $\mbox{get\_input}(Â·)$ã€‚

4. **32ä½æ•´æ•°å€¼ï¼š**
   - SIMPILä¸­çš„è¡¨è¾¾å¼è¢«è®¤ä¸ºæ±‚å€¼ä¸º32ä½æ•´æ•°å€¼ã€‚é€šè¿‡ä¸“æ³¨äºè¿™ç§ç±»å‹ï¼Œè¯­è¨€å’Œè§„åˆ™ä¿æŒç®€å•ï¼Œä½†æè¿°ä¸­æåˆ°å¯ä»¥è½»æ¾æ‰©å±•è¯­è¨€å’Œè§„åˆ™ä»¥é€‚åº”å…¶ä»–ç±»å‹ã€‚

## Operational Semantics
![Meta-Syntactic Variables](/All_You_Ever_Wanted_to_Know_About_Dynamic_Taint_Analysis_and_Forward_Symbolic_Executioné˜…è¯»/image3.png){width=400px}

![Operational Semantics of SIMPIL](/All_You_Ever_Wanted_to_Know_About_Dynamic_Taint_Analysis_and_Forward_Symbolic_Executioné˜…è¯»/image2.png)

1. **æ“ä½œè¯­ä¹‰è§„åˆ™ï¼š**
   - SIMPILè¯­è¨€çš„æ“ä½œè¯­ä¹‰åœ¨å›¾1ä¸­å±•ç¤ºã€‚
   - æ¯ä¸ªè¯­å¥è§„åˆ™çš„å½¢å¼ä¸ºï¼š  
     $$\frac{\mbox{computation}}{\langle \mbox{current state}\rangle, \mbox{stat} \rightsquigarrow \langle\mbox{end state}\rangle, \mbox{statâ€™} }$$
     è¿™è¡¨ç¤ºä»å½“å‰çŠ¶æ€æ‰§è¡Œä¸€ä¸ªåœ¨è§„åˆ™ä¸­æŒ‡å®šçš„è®¡ç®—ï¼Œç„¶åè½¬ç§»åˆ°ä¸€ä¸ªå¸¦æœ‰ä¿®æ”¹è¯­å¥çš„ç»ˆæ€ã€‚

2. **è§„åˆ™åº”ç”¨ï¼š**
   - è§„åˆ™ä»åº•éƒ¨åˆ°é¡¶éƒ¨ã€ä»å·¦åˆ°å³é˜…è¯»ã€‚
   - ç»™å®šä¸€æ¡è¯­å¥ï¼Œé€šè¿‡æ¨¡å¼åŒ¹é…ç¡®å®šé€‚ç”¨çš„è§„åˆ™ã€‚ä¾‹å¦‚ï¼Œå¦‚æœè¯­å¥æ˜¯èµ‹å€¼è¯­å¥ $x := e$ ï¼Œåˆ™åŒ¹é…åˆ° ASSIGN è§„åˆ™ã€‚
   - ç„¶ååº”ç”¨åŒ¹é…è§„åˆ™ä¸­çš„è®¡ç®—ï¼Œå¦‚æœæˆåŠŸï¼Œå°±è½¬ç§»åˆ°ç»ˆæ€ã€‚
   - å¦‚æœæ²¡æœ‰åŒ¹é…çš„è§„åˆ™ï¼ˆæˆ–å‰æä¸­çš„è®¡ç®—å¤±è´¥ï¼‰ï¼Œåˆ™æœºå™¨å¼‚å¸¸ç»ˆæ­¢ã€‚

3. **æ‰§è¡Œä¸Šä¸‹æ–‡ï¼š**
   - ç”±äº”ä¸ªå‚æ•°æè¿°ï¼š$\Sigma$ï¼ˆç¨‹åºè¯­å¥åˆ—è¡¨ï¼‰ã€$\mu$ï¼ˆå½“å‰å†…å­˜çŠ¶æ€ï¼‰ã€$\Delta$ï¼ˆå½“å‰å˜é‡å€¼ï¼‰ã€$pc$ï¼ˆç¨‹åºè®¡æ•°å™¨ï¼‰å’Œ$\iota$ï¼ˆå½“å‰è¯­å¥ï¼‰ã€‚
   - $\Sigma$ã€$\mu$ å’Œ $\Delta$ éƒ½èµ·æ˜ å°„çš„ä½œç”¨ã€‚ä¾‹å¦‚ï¼Œ$\Delta[x]$ è¡¨ç¤ºå˜é‡ $x$ çš„å½“å‰å€¼ã€‚
   - æ›´æ–°ä¸Šä¸‹æ–‡å˜é‡ $x$ ä¸ºå€¼ $v$ è¡¨ç¤ºä¸º $x\leftarrow v$ã€‚

4. **ç¨‹åºä¸Šä¸‹æ–‡çš„ç¨³å®šæ€§ï¼š**
   - åœ¨è¯„ä¼°è§„åˆ™ä¸­ï¼Œç¨‹åºä¸Šä¸‹æ–‡ $\Sigma$ åœ¨è½¬æ¢è¿‡ç¨‹ä¸­ä¸ä¼šæ”¹å˜ã€‚
   - è¿™æ„å‘³ç€SIMPILçš„æ“ä½œè¯­ä¹‰ä¸å…è®¸å…·æœ‰åŠ¨æ€ç”Ÿæˆä»£ç çš„ç¨‹åºã€‚å¦‚ä½•æ”¯æŒåŠ¨æ€ç”Ÿæˆä»£ç å’Œå…¶ä»–é«˜çº§è¯­è¨€ç‰¹æ€§åé¢ä¼šèŠã€‚

5. **è¡¨è¾¾å¼çš„è¯„ä¼°è§„åˆ™ï¼š**
   - è¡¨è¾¾å¼çš„è¯„ä¼°è§„åˆ™ä½¿ç”¨ç±»ä¼¼çš„ç¬¦å·è¡¨ç¤ºã€‚
   - $\vdash$ æ˜¯â€œæ¨å¯¼â€æˆ–â€œå¯¼å‡ºâ€çš„ç¬¦å·ï¼Œè¡¨ç¤ºæ ¹æ®ç»™å®šçš„ä¸Šä¸‹æ–‡å’Œè§„åˆ™å¯ä»¥æ¨å¯¼å‡ºæŸä¸ªç»“è®ºã€‚
   - $\mu, \Delta\vdash e \Downarrow v$ è¡¨ç¤ºåœ¨ç»™å®šç”± $\mu$ å’Œ $\Delta$ è¡¨ç¤ºçš„å½“å‰çŠ¶æ€ä¸­ï¼Œå°†è¡¨è¾¾å¼ $e$ è¯„ä¼°ä¸ºå€¼ $v$ã€‚å¯¹è¡¨è¾¾å¼ $e$ çš„è¯„ä¼°è¿‡ç¨‹åŒ…æ‹¬å°† $e$ ä¸è¡¨è¾¾å¼è¯„ä¼°è§„åˆ™è¿›è¡ŒåŒ¹é…ï¼Œç„¶åæ‰§è¡Œè§„åˆ™ä¸­é™„å¸¦çš„è®¡ç®—ã€‚
   - åœ¨å½¢å¼åŒ–çš„è¯­è¨€è§„èŒƒä¸­ï¼Œé€šå¸¸ä¼šå®šä¹‰ä¸€ç»„è§„åˆ™ï¼Œæ¯æ¡è§„åˆ™å¯¹åº”ä¸€ç±»è¡¨è¾¾å¼ç»“æ„ã€‚è¯„ä¼°è¡¨è¾¾å¼å°±æ˜¯æŒ‰ç…§è¿™äº›è§„åˆ™è¿›è¡ŒåŒ¹é…å’Œè®¡ç®—ã€‚

ä¸¾ä¸ªğŸŒ°ï¼š

![](/All_You_Ever_Wanted_to_Know_About_Dynamic_Taint_Analysis_and_Forward_Symbolic_Executioné˜…è¯»/image4.png){width=400px}

![](/All_You_Ever_Wanted_to_Know_About_Dynamic_Taint_Analysis_and_Forward_Symbolic_Executioné˜…è¯»/image5.png)

## Special Case Discussion
å‡ºäºç®€å•çš„è§’åº¦è€ƒè™‘ï¼Œå¹¶æ²¡æœ‰high-levelçš„è¯­è¨€ç»“æ„ï¼Œä¾‹å¦‚å‡½æ•°ã€ä½œç”¨åŸŸç­‰ã€‚

è§£å†³æ–¹æ¡ˆå¦‚ä¸‹ï¼š

1. å°†ç¼ºå¤±çš„é«˜çº§è¯­è¨€ç»“æ„ç¼–è¯‘ä¸º SIMPIL statements è€Œéæ±‡ç¼–æŒ‡ä»¤ã€‚
    - ä¸¾ä¾‹æ¥è¯´ï¼Œå¯ä»¥å°†é«˜çº§ä»£ç ä¸­çš„å‡½æ•°è°ƒç”¨ç¼–è¯‘æˆåœ¨SIMPILä¸­å­˜å‚¨è¿”å›åœ°å€å¹¶è½¬ç§»æ§åˆ¶æµçš„æ“ä½œã€‚
      ![](/All_You_Ever_Wanted_to_Know_About_Dynamic_Taint_Analysis_and_Forward_Symbolic_Executioné˜…è¯»/image6.png){width=400px}


2. å‘SIMPILæ·»åŠ é«˜çº§ç»“æ„ã€‚
    - å¯ä»¥é€šè¿‡å‘SIMPILä¸­æ·»åŠ CALLå’ŒRETè§„åˆ™æ¥å®ç°å¯¹å‡½æ•°çš„æ”¯æŒã€‚è¿™åŒ…æ‹¬å¼•å…¥æ–°çš„ä¸Šä¸‹æ–‡ï¼Œå¦‚å­˜å‚¨è¿”å›åœ°å€çš„å †æ ˆä¸Šä¸‹æ–‡ï¼ˆ$\lambda$ï¼‰ï¼Œå­˜å‚¨å‡½æ•°å±€éƒ¨å˜é‡ä¸Šä¸‹æ–‡çš„ä½œç”¨åŸŸä¸Šä¸‹æ–‡ï¼ˆ$\zeta$ï¼‰ä»¥åŠä»å‡½æ•°ååˆ°åœ°å€çš„æ˜ å°„ï¼ˆ$\phi$ï¼‰ã€‚
    - ç±»ä¼¼åœ°ï¼Œå¯ä»¥é€šè¿‡é‡æ–°å®šä¹‰æŠ½è±¡æœºå™¨è½¬æ¢æ¥æ”¯æŒåŠ¨æ€ç”Ÿæˆçš„ä»£ç ã€‚è¿™æ¶‰åŠå…è®¸å¯¹ç¨‹åºä¸Šä¸‹æ–‡ï¼ˆ$\Sigma$ï¼‰è¿›è¡Œæ›´æ–°ï¼Œå¹¶æä¾›å°†ç”Ÿæˆçš„ä»£ç æ·»åŠ åˆ° $\Sigma$ çš„è§„åˆ™GENCODEã€‚
  
    ![](/All_You_Ever_Wanted_to_Know_About_Dynamic_Taint_Analysis_and_Forward_Symbolic_Executioné˜…è¯»/image7.png)


# Dynamic Taint Analysis
Dynamic Taint Analysisçš„ä¸»è¦æ€æƒ³æ˜¯æ ‡è®°ï¼ˆæˆ–æ±¡ç‚¹ï¼‰ç¨‹åºä¸­çš„æ•°æ®ï¼Œå¹¶è·Ÿè¸ªè¿™äº›æ ‡è®°åœ¨ç¨‹åºæ‰§è¡ŒæœŸé—´çš„ä¼ æ’­ã€‚è¿™æ ·å¯ä»¥å¸®åŠ©è¯†åˆ«æ½œåœ¨çš„å®‰å…¨æ¼æ´ï¼Œå°¤å…¶æ˜¯ä¸æ•°æ®æµç›¸å…³çš„é—®é¢˜ï¼Œä¾‹å¦‚ä¿¡æ¯æ³„éœ²ã€æœªç»æˆæƒçš„æ•°æ®ä¿®æ”¹ç­‰ã€‚

# Forward Symbolic Execution

Forward Symbolic Executionè‡ªåŠ¨åœ°æ¢ç´¢ç¨‹åºçš„æ‰§è¡Œè·¯å¾„ï¼Œä»¥ä¾¿å¯»æ‰¾æ½œåœ¨çš„é”™è¯¯ã€æ¼æ´æˆ–å…¶ä»–å®‰å…¨é—®é¢˜ã€‚è¯¥æŠ€æœ¯çš„æ ¸å¿ƒæ€æƒ³æ˜¯ä»¥ç¬¦å·å½¢å¼è¡¨ç¤ºç¨‹åºçš„è¾“å…¥ï¼Œå¹¶é€šè¿‡æ¨¡æ‹Ÿç¨‹åºæ‰§è¡Œè¿‡ç¨‹æ¥æ¨å¯¼å‡ºç¬¦å·æ‰§è¡Œè·¯å¾„ï¼Œä»è€Œå‘ç°æ½œåœ¨çš„é—®é¢˜ã€‚
```mermaid
graph LR;
    A[Symbolic Execution]-->B[Forward Symbolic Execution];
    A[Symbolic Execution]-->C[Backward Symbolic Execution];
```
